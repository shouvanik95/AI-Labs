:- use_module(library(clpfd)).

gMagic(Msq, Fname) :- 
    Msq = [X1, X2, X3, X4, X5, X6, X7, X8, 
           X9, X10, X11, X12, X13, X14, X15, X16],
    see(Fname), read(sum(Sum)),
    read(msq([X1, X2, X3, X4, X5, X6, X7, X8, 
              X9, X10, X11, X12, X13, X14, X15, X16])), seen,
    X1 + X2 + X3 + X4 #= Sum,
    X5 + X6 + X7 + X8 #= Sum,
    X9 + X10 + X11 + X12 #= Sum,
    X13 + X14 + X15 + X16 #= Sum,
    X1 + X5 + X9 + X13 #= Sum,
    X2 + X6 + X10 + X14 #= Sum,
    X3 + X7 + X11 + X15 #= Sum,
    X4 + X8 + X12 + X16 #= Sum,
    X1 + X6 + X11 + X16 #= Sum,
    X4 + X7 + X10 + X13 #= Sum,
    X1 in 1..Sum,
    X2 in 1..Sum,
    X3 in 1..Sum,
    X4 in 1..Sum,
    X5 in 1..Sum,
    X6 in 1..Sum,
    X7 in 1..Sum,
    X8 in 1..Sum,
    X9 in 1..Sum,
    X10 in 1..Sum,
    X11 in 1..Sum,
    X12 in 1..Sum,
    X13 in 1..Sum,
    X14 in 1..Sum,
    X15 in 1..Sum,
    X16 in 1..Sum,
    all_distinct(Msq),
    label(Msq),
    write('    '), write(X1), write('  '), write(X2), write('  '), 
               write(X3), write(' '), write(X4), nl, 
    write('    '), write(X5), write('  '), write(X6), write('  '), 
               write(X7), write(' '), write(X8), nl, 
    write('    '), write(X9), write('  '), write(X10), write('  '), 
               write(X11), write(' '), write(X12), nl, 
    write('    '), write(X13), write('  '), write(X14), write('  '), 
               write(X15), write(' '), write(X16), nl.

	
